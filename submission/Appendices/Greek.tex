\chapter{Ελληνική Μετάφραση}
\label{appendices:greek}

Εδώ θα παραθέσουμε μια εκτενή περίληψη της παρούσας εργασίας στα ελληνικά.


\section{Εισαγωγή}
Το Pidgin είναι μια διαδεδομένη εφαρμογή desktop για συνομιλίες πραγματικού χρόνου.
Συνοδεύεται από το OTR πρόσθετο το οποίο, χρησιμοποιώντας το OTR πρωτόκολλο \cite{otr} \cite{otr_improvedauth} \cite{otr_userstudy}, προσθέτει στο Pidgin τη δυνατότητα των από άκρο σε άκρο κρυπτογραφημένων συνομιλιών μεταξύ δύο ατόμων.
Έτσι προσφέρει ασφαλείς συνομιλίες στις οποίες μόνο οι συνδιαλεγόμενοι μπορούν να διαβάσουν τα μηνύματα που ανταλλάσσονται, τα οποία είναι κρυφά ακόμα και στον πάροχο επικοινωνίας.
Παρότι το ίδιο το OTR πρόσθετο προσφέρει συνομιλίες μόνο δύο ατόμων, τα υποβόσκωντα πρωτόκολλα συχνά παρέχουν "δωμάτια" πολλών χρηστών, όπου πολλοί μπορούν να συνομιλούν ταυτόχρονα μεταξύ τους.
Μέχρι τώρα όσοι μιλούσαν σε τέτοιου είδους δωμάτια δεν απολάμβαναν τα πλεονεκτήματα της από άκρο σε άκρο κρυπτογράφησης.

Στόχος της εργασίας μας είναι η υλοποίηση μιας βιβλιοθήκης για ασφαλείς συνομιλίες μεταξύ πολλών ατόμων.
Επιπρόσθετα υλοποιούμε κι ένα πρόσθετο για το Pidgin το οποίο χρησιμοποιεί αυτή τη βιβλιοθήκη έτσι ώστε να επιτρέπει τους χρήστες του Pidgin να συνομιλούν ασφαλώς σε ένα οικείο περιβάλλον.

Η δουλειά μας βασίζεται θεμελιωδώς στο mpOTR paper \cite{mpotr}.
Ακολουθώντας τις συμβάσεις του OTR πρωτοκόλλου, ο όρος "ιδιωτικός" χρησιμοποιείται για να περιγράψει τις ιδιότητες των συνομιλιών της πραγματικής ζωής:

\begin{itemize}
  \item Εμπιστευτικότητα\\
    Μόνο οι συμμετέχοντες μπορούν να διαβάσουν τα μηνύματα\\[0.2cm]

  \item Αυθεντικοποίηση\\
    Οι συμμετέχοντες είναι βέβαιοι ότι πραγματικά μιλάνε σε αυτούς που νομίζουν ότι μιλάνε\\[0.2cm]

  \item Διαψευσιμότητα\\
    Κανείς δε μπορεί να αποδείξει σε κάποιον που δε συμμετείχε στη συνομιλία, ότι κάποιο συγκεκριμένος συμμετέχοντας έλαβε μέρος στη συνομιλία αυτή\\[0.2cm]

  \item Προώθηση Μυστικότητας\\
    Εάν τα μακροπρόθεσμα μυστικά ενός χρήστη εκτεθούν σε κάποιον επιτιθέμενο, τότε αυτός δε μπορεί να διαβάσει κανένα μήνυμα το οποίο στάλθηκε παλαιότερα\\[0.2cm]

\end{itemize}

Όταν έχουμε να κάνουμε για συνομιλίες πολλών ατόμων, μια ακόμα ιδιότητα απαιτείται.
Αυτή η ιδιότητα λέγεται συνέπεια περιεχομένων δωματίου, και γενικά δηλώνει ότι όλοι οι συμμετέχοντες έχουν την ίδια εικόνα για τα μηνύματα που έχουν σταλθεί σε κάποιο δωμάτιο.

Για να υλοποιήσουμε το mpOTR πρωτόκολλο το οποίο περιγράφεται στο \cite{mpotr}, έπρεπε να συγκεκριμενοποιήσουμε τα υπο-πρωτόκολλα τα οποία χρησιμοποιούταν ως μαύρα κουτιά και δεν περιγράφηκαν πλήρως.
Προτείνουμε μια συγκεκριμένη Διαψεύσιμη Ανταλλαγή Κλειδιών Υπογραφής (DSKE) η οποία βασίζεται σε εκτέλεση κατά ζεύγη του τριπλού \dhname πρωτοκόλλου.
Για την Ομαδική Συμφωνία Κλειδιού (GKA) χρησιμοποιούμε το πρωτόκολλο που περιγράφεται στο \cite{mpenc}, αλλά χρησιμοποιούμε κλασσικό \dhname (δηλαδή όχι \dhname ελλειπτικών καμπυλών).

Υλοποιούμε την mpOTR βιβλιοθήκη ως κομμάτι της αρχικής OTR βιβλιοθήκης όπως φαίνεται στο \href{https://github.com/Mandragorian/libotr/tree/mpotr}{το github repo μας\footnote{https://github.com/Mandragorian/libotr/tree/mpotr}}, η οποία μέχρι τώρα πρόσφερε συνομιλίες μόνο για δύο συμμετέχοντες.
Το πρόσθετο μας βασίζεται στο ήδη υπάρχον OTR πρόσθετο το οποίο αναπτύσσεται από την κοινότητα του OTR, και μπορεί κανείς να το δει στο \href{https://github.com/Mandragorian/pidgin_otr/tree/mpotr_integration}{το github repo μας\footnote{https://github.com/Mandragorian/pidgin\_otr/tree/mpotr\_integration}}.
%------------------------------------------------

\section{Το Πρωτόκολλο}

Στον αλγόριθμο \ref{algorithms:mpotr_algo} παρουσιάζουμε τη συμπεριφορά του πρωτοκόλλου.
Το πρωτόκολλο χωρίζεται σε διάφορες φάσεις τις οποίες ονομάζουμε υπο-πρωτόκολλα.
Τα τέσσερα πρώτα από αυτά (Offer, DSKA, GKA και Attest) είναι υπεύθυνα για να κατασκευάσουν όλη την απαραίτητη πληροφορία που απαιτείται ώστε να λάβει χώρα μια ιδιωτική συνομιλία.
Το Communication υπο-πρωτόκολλο είναι αυτό το οποίο αναλαμβάνει να φέρει εις πέρας την ίδια τη συνομιλία.
Τέλος το Shutdown υπο-πρωτόκολλο είναι υπεύθυνο ώστε να γίνει κάθε απαιτούμενη ενέργεια που πρέπει να συμβεί πριν κλείσει μια συνομιλία.
Παρουσιάζουμε εν συντομία τα υπο-πρωτόκολλα αυτά παρακάτω.

Κατά τη διάρκεια του Offer υπο-πρωτοκόλλου, οι συμμετέχοντες υπολογίζουν ένα αναγνωριστικό $sid$ για τη συνομιλία.
Αυτό είναι ένας αριθμός, μοναδικός με μεγάλη πιθανότητα, που ταυτοποιεί τη συνομιλία.

Κατά το DSKE υπο-πρωτόκολλο, κάθε συμμετέχοντας κατασκευάζει έναν πίνακα αντιστοίχησης $\mathcal{S}$ ο οποίος αντιστοιχεί κάθε συμμετέχοντα σε ένα κλειδί υπογραφής το οποίο θα χρησιμοποιηθεί γι αυτή τη συνομιλία.
Κάθε συμμετέχοντας παράγει ένα εφήμερο κλειδί υπογραφής με το οποίο θα αυθεντικοποιεί τα μηνύματά του.
Έπειτα κάθε συμμετέχοντας στέλνει το δημόσιο κομμάτι του κλειδιού υπογραφής του με κάθε άλλο συμμετέχοντα, χρησιμοποιώντας μια Διαψεύσιμη Αυθεντικοποιημένη Ανταλλαγή Κλειδιού (DAKE).
Όταν όλοι έχουν ανταλλάξει τα κλειδιά τους με όλους ο κάθε συμμετέχοντας έχει κατασκευάσει τον πίνακα αντιστοίχισης του.
Αφού η ανταλλαγή κλειδιού είναι διαψεύσιμη, το ίδιο ισχύει και για τα κλειδιά υπογραφής.
Θα μιλήσουμε πιο αναλυτικά για το DSKE και το DAKE στην παράγραφο (\ref{dske_subprot}).

Κατά το GKA υπο-πρωτόκολλο, οι συμμετέχοντες παράγουν ένα κοινό κλειδί $\mathcal{K}$ το οποίο θα χρησιμοποιηθεί για να παραχθούν κλειδιά κρυπτογράφησης.
Τα κλειδιά αυτά θα χρησιμοποιηθούν για να κρυπτογραφηθούν τα μηνύματα που θα σταλούν κατά τη συνομιλία.
Το υπο-πρωτόκολλο αυτό περιγράφεται αναλυτικότερα στην παράγραφο (\ref{gka_subprot}).

Κατά το Attest υπο-πρωτόκολλο οι συμμετέχοντες αυθεντικοποιούν το αναγνωριστικό $sid$ και σιγουρεύονται ότι έχουν φτάσει στον ίδιο πίνακα αντιστοίχισης κλειδιών υπογραφής $\mathcal{S}$.

Κατά το Communication υπο-πρωτόκολλο, λαμβάνει χώρα η ίδια η συνομιλία.
Οι χρήστες χρησιμοποιούν το κοινό μυστικό $\mathcal{K}$, τα εφήμερα κλειδιά υπογραφής και τον πίνακα αντιστοίχισης $\mathcal{S}$, ώστε να κρυπτογραφήσουν και να αυθεντικοποιήσουν τα μηνύματά τους.
Όταν τελειώσει αυτή η φάση παράγεται ένα αντίγραφο της συνομιλίας το οποίο περιέχει όλα τα μηνύματα της συνομιλίας.

Κατά το Shutdown υπο-πρωτόκολλο, οι συμμετέχοντας αποφασίζουν αν υπάρχει συνέπεια περιεχομένων δωματίου και αποκαλύπτουν τα ιδιωτικά κομμάτια των κλειδιών υπογραφής τους.
Εάν τα περιεχόμενα είναι όντως συνεπή τότε λέμε ότι υπάρχει ομοφωνία.
Η αποκάλυψη των ιδιωτικών κλειδιών υπογραφής προσθέτει επιπλέον διαψευσιμότητα στο πρωτόκολλο, όπως και η αποκάλυψη των MAC κλειδιών στο OTR πρωτόκολλο.
Παρόλα αυτά είναι προαιρετικό βήμα καθώς το πρωτόκολλο που προτείνεται είναι διαψεύσιμο και χωρίς την αποκάλυψη.

\section{Τα υπο-πρωτόκολλα}
\label{subprots}

Εδώ θα παρουσιάσουμε τα δύο υπο-πρωτόκολλα τα οποία δεν περιγράφονται στο \cite{mpotr}, δηλαδή τη Διαψεύσιμη Ανταλλαγή Κλειδιών Υπογραφής και την Ομαδική Συμφωνία Κλειδιού.

\subsection{DSKE}
\label{dske_subprot}

Στο\cite{mpotr} η ανταλλαγή κλειδιών υπογραφής περιγράφηκε χρησιμοποιώντας ένα πρωτόκολλο που το ονόμαζε ως Διαψεύσιμη Αυθεντικοποιημένη Ανταλλαγή Κλειδιού (DAKE) ως μαύρο κουτί.
Στην υλοποίησή μας χρησιμοποιούμε το τριπλό \dhname πρωτόκολλο ως DAKE, το οποίο είναι αυθεντικοποιημένο και διαψεύσιμο.

Κάθε συμμετέχοντας εκτελεί μια τριπλή \dhname ανταλλαγή κλειδιού με κάθε άλλο συμμετέχοντα στο δωμάτιο και έτσι κατασκευάζουν ένα κοινό μυστικό.
Με αυτό το μυστικό θα κρυπτογραφήσει και έπειτα θα αυθεντικοποιήσει το δημόσιο κομμάτι του κλειδιού υπογραφής του, και θα στείλει το αποτέλεσμα στον άλλον συμμετέχοντα.

Αφού όλοι οι συμμετέχοντας έχουν ανταλλάξει τα κλειδιά υπογραφής τους με όλους τους άλλους, με τον τρόπου που περιγράφηκε παραπάνω, έχουν σχηματίσει τον πίνακα αντιστοίχησης $\mathcal{S}$.
Είναι άξιο να σημειωθεί ότι η DSKE είναι η μόνη φάση κατά την εγκατάσταση της συζήτησης κατά την οποία $O(n^2)$ μηνύματα ανταλλάσσονται.
Μετά στέλνονται $O(n)$ μηνύματα.

Μια σχηματική περιγραφή του πρωτοκόλλου φαίνεται στο σχήμα \ref{den_ake_schematic}.


\subsection{GKA}
\label{gka_subprot}


Για την Ομαδική Συμφωνία Κλειδιού χρησιμοποιούμε το πρωτόκολλο που περιγράφεται στο \cite{mpenc}.
Επαναλαμβάνουμε ότι η βασική ιδέα είναι η \dhname ανταλλαγή κλειδιού, γενικευμένη για πολλούς συμμετέχοντες.

Κατά τη GKA τα μηνύματα ανταλλάσσονται σε δύο φάσεις. Στη φάση της ροής και στη φάση της αντιροής.
Κατά τη φάση της ροής τα μηνύματα ανταλλάσσονται σειριακά μεταξύ των συμμετεχόντων.
Ο κάθε συμμετέχοντας υπολογίζει κάποια ενδιάμεσα κλειδιά, βασιζόμενος στα ενδιάμεσα κλειδιά που έλαβε από τον προηγούμενό του.
Τα ενδιάμεσα κλειδιά αυτά θα τα στείλει στον επόμενο του.
Μετά το πέρας της φάσης ροής, ο τελευταίος συμμετέχοντας έχει αρκετά δεδομένα ώστε να παράξει το κοινό μυστικό.
Επίσης έχει όλη την πληροφορία που χρειάζεται και από τους υπόλοιπους συμμετέχοντες, ώστε να φτιάξουν και αυτοί το κοινό μυστικό.
Αυτή η πληροφορία μεταδίδεται στους υπολοίπους όπως φαίνεται στο σχήμα \ref{figures:gka_downflow}.

Στους αλγορίθμους \ref{upflow_algo}, \ref{downflow_algo}, και \ref{gka_proto_algo} παρουσιάζεται η κεντρική ιδέα της GKA.


\section{The primitives}

\subsection{Ομάδα Diffie--Hellman}

Στην υλοποίηση μας επαναχρησιμοποιήσαμε τον κώδικα για την ανταλλαγή κλειδιού \dhname από τη βιβλιοθήκη libotr.
Αυτό σημαίνει ότι χρησιμοποιούμε κλασσικό \dhname και συγκεκριμένα την ομάδα υπ. αριθμόν 5 με συντελεστή μήκους 1536 bit.
Στους αλγορίθμους που περιγράψαμε παραπάνω όλες οι υψώσεις σε εκθέτη γίνονται σε αυτή την ομάδα.

\subsection{Κρυπτογράφηση}

Για την κρυπτογράφηση χρησιμοποιούμε AES-128 σε Counter τρόπο λειτουργίας, όπως και στο απλό OTR.
Επιλέξαμε τον AES με κλειδί 128 bit και όχι με 256 αφενός γιατί η ομάδα \dhname που χρησιμοποιούμε δεν παρέχει 256 bit εντροπίας και αφετέρου εξαιτίας διαφόρων μελετών που υποδεικνύουν ότι o αλγόριθμος δρομολόγησης κλειδιού του AES-128 είναι πιο ανθεκτικός σε επιθέσεις \cite{aes-key-recov} \cite{rijndael-improved-analysis}.

Για να κρυπτογραφηθεί ένα μήνυμα, ο χρήστης παραθέτει το κοινό μυστικό με το προσωπικό του αναγνωριστικό για τη συζήτηση και δημιουργεί ένα προσωπικό κλειδί ως εξής:

\[
k_{enc} = H(id_{προσωπικο} || master\ key)
\]

Για τον μετρητή ο κάθε χρήστης διατηρεί τοπικά το δικό του προσωπικό πάνω μισό (τα 8 πιο σημαντικά bytes) το οποίο αυξάνει κατά 1 κάθε φορά που στέλνει ένα μήνυμα.
Το κάτω μισό (8 λιγότερο σημαντικά bytes) είναι πάντα αρχικοποιημένα στο 0.
Σε κάθε μήνυμα που στέλνεται προστίθεται το πάνω μισό του μετρητή.
Το κρυπτοκείμενο παράγεται ως εξής (όπου $ctr$ είναι το πάνω μισό του μετρητή):

\[
ciphertext = AES_{CTR}(k_{enc}, ctr||0, plaintext)
\]

Για να αποκρυπτογραφηθεί ένα μήνυμα, ο χρήστης παραθέτει το κοινό μυστικό με το προσωπικό id του αποστολέα του μηνύματος.

\[
k_{dec} = H(id_{sender} || master\ key)
\]

Και με τον μετρητή που υπάρχει στο μήνυμα αποκρυπτογραφεί ως εξής:

\[
plaintext = AES_{CTR}(k_{dec}, ctr||0, ciphertext)
\]

Αυτό το σχήμα κρυπτογράφησης χρησιμοποιείται ώστε να μην υπάρχει πιθανότητα να επαναχρησιμοποιηθεί κάποια δυάδα μετρητή-κλειδιού κρυπτογράφησης, κάτι που ο Counter τρόπος λειτουργίας απαιτεί να μη συμβεί.

\subsection{Authentication}

Για τις υπογραφές χρησιμοποιούμε τον αλγόριθμο EdDSA πάνω στην καμπύλη Ed25519
Κάθε μήνυμα υπογράφεται στο σύνολο του.
Επιλέχτηκε αυτός ο αλγόριθμος για τη γρήγορη παραγωγή κλειδιού αλλά και για το μικρό μήκος υπογραφής.
Αυτό σημαίνει ότι η υπογραφή καλύπτει τόσο τα δεδομένα όσο και τα μέταδεδομένα του μηνύματοσ, όπως το αναγνωριστικό της συνομιλίας, την τιμή του μετρητή και άλλα.
